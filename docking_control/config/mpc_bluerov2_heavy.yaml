horizon: 40
dt: 0.0125
quiet: True
thrusters: 8
full_body: True
control_axes: 6

cbf:
  enabled: True
  penalty: 10000.0
  settling_time: 0.1
  type: tube # Options: sphere, tube, frustum
  specs:
    start_radius: 0.5
    end_radius: 0.1
    radius: 0.5

noises:
  # Process noise (how much we trust the physics model)
  Q_eta: 1.0e-4
  Q_nu_r: 1.0e-3

  # --- Measurement Noise (Sensor Quality) ---
  # Position from acoustics (e.g., USBL), std dev ~0.1m
  R_xy: 0.01
  # Depth from pressure sensor, std dev ~0.1m
  R_z: 0.01

  # Attitude from a mid-grade IMU, std dev ~0.5 degrees
  R_att: 7.6e-5 # (0.5 * pi/180)^2

  # Linear velocity from a standard DVL, std dev ~1 cm/s
  R_linvel: 1.0e-4 # (0.01)^2

  # Angular velocity from a mid-grade IMU, std dev ~0.5 deg/s
  R_angvel: 7.6e-5 # (0.5 * pi/180)^2

  # Values below are less critical for this specific estimator
  R_dr: 2e-6
  Q_f: 1e-6
  R_linacc: 1e-6

penalty:
  # Q: Penalties on state errors. Position and Yaw penalties are very high.
  Q: [
      # Position (x, y, z)
      500.0,  # X Position (Very high for precise tracking)
      500.0,  # Y Position (High, but less than X/Z)
      750.0,  # Z Position (Highest priority for aggressive vertical control)

      # Orientation (roll, pitch, yaw)
      600.0,  # Roll (Extremely high for stability)
      600.0,  # Pitch (Extremely high for stability)
      600.0,  # Yaw (Very high for precise heading control)

      # Linear Velocity (u, v, w) - Moderate damping
      70.0,
      70.0,
      70.0,

      # Angular Velocity (p, q, r) - Moderate damping on rotations
      90.0,
      90.0,
      90.0
    ]

  # P: Terminal state penalties - Set equal to Q for consistent tracking
  P: [
      500.0, 500.0, 750.0,  # Position
      600.0, 600.0, 600.0,  # Orientation
      70.0, 70.0, 70.0,     # Linear Velocity
      90.0, 90.0, 90.0      # Angular Velocity
    ]

  # R: Penalties on control inputs. Very low values to allow for aggressive thrust.
  # R: [
  #     # Force (Fx, Fy, Fz)
  #     0.05,  # Fx (Very cheap for maximum forward/backward thrust)
  #     0.5,  # Fy (Slightly more expensive for smoother lateral moves)
  #     0.025, # Fz (Extremely cheap for rapid depth changes)

  #     # Torque (Tx, Ty, Tz)
  #     25.0,   # Roll Torque (Still expensive to prevent instability)
  #     25.0,   # Pitch Torque (Still expensive to prevent instability)
  #     0.01   # Yaw Torque (Very cheap for fast, precise heading adjustments)
  #   ]

  R: [
      # Force (Fx, Fy, Fz)
      0.05,  # Fx (Surge): Moderately expensive to encourage smooth acceleration.
      0.5,  # Fy (Sway): Most expensive force, as lateral motion is less efficient.
      0.05,  # Fz (Heave): Less expensive than surge/sway for responsive depth control.

      # Torque (Tx, Ty, Tz)
      50.0,   # Tx (Roll): Very expensive to maintain stability.
      50.0,   # Ty (Pitch): Very expensive to maintain stability.
      5.0    # Tz (Yaw): Significantly more expensive to prevent jerky, twitchy turns.
    ]

  R_pwm: 1e-4

bounds:
  xmin:
    [
      -100,
      -100,
      -100,
      -3.14,
      -3.14,
      -3.14,
      -2.0,
      -2.0,
      -2.0,
      -0.25,
      -0.25,
      -0.25,
    ]
  xmax: [100, 100, 100, 3.14, 3.14, 3.14, 2.0, 2.0, 2.0, 0.25, 0.25, 0.25]

  # umin: [-0.1, -0.1, -0.1, -0.1, -0.1, -0.1]
  # umax: [0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
  # umin: [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0]
  # umax: [1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
  # umin: [-5.0, -5.0, -5.0, -5.0, -5.0, -5.0]
  # umax: [5.0, 5.0, 5.0, 5.0, 5.0, 5.0]
  # umin: [-50.0, -50.0, -50.0, -50.0, -50.0, -50.0]
  # umax: [50.0, 50.0, 50.0, 50.0, 50.0, 50.0]

  umin: [-50.0, -50.0, -50.0, -10.0, -10.0, -50.0]
  umax: [50.0, 50.0, 50.0, 10.0, 10.0, 50.0]
  # umin: [-100.0, -100.0, -100.0, -100.0, -100.0, -100.0]
  # umax: [100.0, 100.0, 100.0, 100.0, 100.0, 100.0]

  # dumin: [-0.1, -0.1, -0.1, -0.1, -0.1, -0.1]
  # dumax: [0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
  dumin: [-0.5, -0.5, -0.5, -0.5, -0.5, -0.5]
  dumax: [0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
  # dumin: [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0]
  # dumax: [1.0, 1.0, 1.0, 1.0, 1.0, 1.0]

  pwm_min: 1100
  pwm_max: 1900

  min_rpm: -4000
  max_rpm: 4000
